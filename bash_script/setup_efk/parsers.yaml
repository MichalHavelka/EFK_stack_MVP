parsers:
  - name: nginx
    format: regex
    time_key: time
    regex: '^(?<remote>\S+)\s+(?<host>\S+)\s+(?<user>\S+)\s+\[(?<time>[^\]]+)\]\s+"(?<method>\S+)(?:\s+(?<path>[^"]*?)(?:\s+\S*)?)?"\s+(?<code>\d+)\s+(?<size>\d+)\s+"(?<referer>[^"]*)"\s+"(?<agent>[^"]*)"(?:\s+"(?<http_x_forwarded_for>[^"]*)")?$'
    time_format: '%d/%b/%Y:%H:%M:%S %z'
  - name: monitoring_stack
    format: logfmt
    logfmt_no_bare_keys: true
